!function(t){t.pjaxTransition=function(n){if(t.support.pjax){var i={container:".pjax-transition-container",linkSelector:"a",transition:function(){var i=this.next.find("[data-pjax-transition]");i.length||(i=this.next),i.css("opacity",0),this.current.replaceWith(this.next),this.fire("start"),i.animate({opacity:1},n.duration/2,t.proxy(function(){this.done()},this))},beforeTransition:function(){var i=this.current.find("[data-pjax-transition]");i.length||(i=this.current),i.animate({opacity:0},n.duration/2,t.proxy(function(){this.transition()},this))},duration:500,animateHistory:!1,loadWhileAnimating:!1,scrollTo:0};n=t.extend({},i,n);var r=t(n.container+":first");r.addClass("pjax-container-current"),t("<script />").attr("id","pjax-container-staging").attr("type","text/html").html(t(".pjax-container-current").clone()).appendTo("body");var e={ready:!1,context:r.parent(),scriptTag:!1,fire:function(t){this.context.trigger("pjax:transition:"+t)},transition:function(){this.ready&&this.next?(n.scrollTo===!1?this.next.css("height",this.current.height()):t(window).scrollTop("function"==typeof n.scrollTo?n.scrollTo.call(this):n.scrollTo),this.next.addClass("pjax-container-current"),n.transition.apply(this,[n])):this.ready=!0},done:function(){this.insertScripts(),t(".pjax-container-current").find("iframe").each(function(){t(this).attr("src",t(this).attr("data-src"))}),setTimeout(t.proxy(function(){this.next.css("height",""),this.next=!1},this),100),this.fire("end"),this.ready=!1},insertScripts:function(){this.scriptTag&&(this.next.append(this.scriptTag),this.scriptTag=!1)}},a=!1;t(document).on("pjax:popstate",function(t){a=!0,o=t.state.url});var o="";t(document).on("click",n.linkSelector,function(t){return t.currentTarget.href===o?(t.preventDefault(),!1):void(o=t.currentTarget.href)}),t(document).on("pjax:start",function(){e.current=t(".pjax-container-current:first"),e.fire("begin"),"function"==typeof n.beforeTransition&&n.loadWhileAnimating?n.beforeTransition.apply(e,[n]):e.ready=!0});var s=0;t(document).on("pjax:success pjax:end",function(i,r,o){("pjax:end"!==i.type||a)&&(a=!1,setTimeout(function(){e.next=t("#pjax-container-staging").find(n.container).clone(),e.next.find("iframe").each(function(){t(this).attr("data-src",t(this).attr("src")),t(this).attr("src",null)});var r=e.next.find("script");r.length?(e.scriptTag=t("<script/>"),r.each(function(){e.scriptTag.append(t(this).html())}),r.remove()):e.scriptTag=!1,"pjax:end"!==i.type||n.animateHistory?n.loadWhileAnimating||"function"!=typeof n.beforeTransition?e.transition():n.beforeTransition.apply(e,[n]):(e.fire("beforeRestore"),e.next.addClass("pjax-container-current"),e.current.replaceWith(e.next),e.done(),e.fire("restore"))},s),s="pjax:end"===i.type?250:0)}),t(document).pjax(n.linkSelector,"#pjax-container-staging",{scrollTo:!1})}}}(jQuery);