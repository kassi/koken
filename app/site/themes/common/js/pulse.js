jQuery.extend(jQuery.easing,{def:"ease-in-out",swing:function(t,n,i,e,o){return jQuery.easing[jQuery.easing.def](t,n,i,e,o)},"ease-in":function(t,n,i,e,o){return e*(n/=o)*n+i},"ease-out":function(t,n,i,e,o){return-e*(n/=o)*(n-2)+i},"ease-in-out":function(t,n,i,e,o){return(n/=o/2)<1?e/2*n*n+i:-e/2*(--n*(n-2)-1)+i}});var Pulse=function(){var P={};with(this){!function(t){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],t):t(jQuery)}(function(t){function n(n){return!n||void 0!==n.allowPageScroll||void 0===n.swipe&&void 0===n.swipeStatus||(n.allowPageScroll=c),void 0!==n.click&&void 0===n.tap&&(n.tap=n.click),n||(n={}),n=t.extend({},t.fn.swipe.defaults,n),this.each(function(){var e=t(this),o=e.data(S);o||(o=new i(this,n),e.data(S,o))})}function i(n,i){function C(n){if(!(rt()||t(n.target).closest(i.excludedElements,jt).length>0)){var e,o=n.originalEvent?n.originalEvent:n,s=k?o.touches[0]:o;return qt=x,k?Ut=o.touches.length:n.preventDefault(),Mt=0,Ot=null,Qt=null,Ft=0,Ht=0,At=0,Lt=1,Rt=0,Kt=dt(),Nt=ft(),st(),!k||Ut===i.fingers||i.fingers===v||N()?(ct(0,s),Xt=kt(),2==Ut&&(ct(1,o.touches[1]),Ht=At=vt(Kt[0].start,Kt[1].start)),(i.swipeStatus||i.pinchStatus)&&(e=M(o,qt))):e=!1,e===!1?(qt=T,M(o,qt),e):(lt(!0),null)}}function D(t){var n=t.originalEvent?t.originalEvent:t;if(qt!==y&&qt!==T&&!at()){var e,o=k?n.touches[0]:n,s=ht(o);if(Yt=kt(),k&&(Ut=n.touches.length),qt=b,2==Ut&&(0==Ht?(ct(1,n.touches[1]),Ht=At=vt(Kt[0].start,Kt[1].start)):(ht(n.touches[1]),At=vt(Kt[0].end,Kt[1].end),Qt=xt(Kt[0].end,Kt[1].end)),Lt=wt(Ht,At),Rt=Math.abs(Ht-At)),Ut===i.fingers||i.fingers===v||!k||N()){if(Ot=Tt(s.start,s.end),R(t,Ot),Mt=bt(s.start,s.end),Ft=mt(),pt(Ot,Mt),(i.swipeStatus||i.pinchStatus)&&(e=M(n,qt)),!i.triggerOnTouchEnd||i.triggerOnTouchLeave){var a=!0;if(i.triggerOnTouchLeave){var r=St(this);a=Ct(s.end,r)}!i.triggerOnTouchEnd&&a?qt=z(b):i.triggerOnTouchLeave&&!a&&(qt=z(y)),qt!=T&&qt!=y||M(n,qt)}}else qt=T,M(n,qt);e===!1&&(qt=T,M(n,qt))}}function $(t){var n=t.originalEvent;return k&&n.touches.length>0?(ot(),!0):(at()&&(Ut=Wt),t.preventDefault(),Yt=kt(),Ft=mt(),H()?(qt=T,M(n,qt)):i.triggerOnTouchEnd||0==i.triggerOnTouchEnd&&qt===b?(qt=y,M(n,qt)):!i.triggerOnTouchEnd&&B()?(qt=y,O(n,qt,p)):qt===b&&(qt=T,M(n,qt)),lt(!1),null)}function E(){Ut=0,Yt=0,Xt=0,Ht=0,At=0,Lt=1,st(),lt(!1)}function I(t){var n=t.originalEvent;i.triggerOnTouchLeave&&(qt=z(y),M(n,qt))}function P(){jt.unbind($t,C),jt.unbind(zt,E),jt.unbind(Et,D),jt.unbind(It,$),Pt&&jt.unbind(Pt,I),lt(!1)}function z(t){var n=t,e=L(),o=F(),s=H();return!e||s?n=T:!o||t!=b||i.triggerOnTouchEnd&&!i.triggerOnTouchLeave?!o&&t==y&&i.triggerOnTouchLeave&&(n=T):n=y,n}function M(t,n){var i=void 0;return K()||U()?i=O(t,n,u):(j()||N())&&i!==!1&&(i=O(t,n,d)),it()&&i!==!1?i=O(t,n,g):et()&&i!==!1?i=O(t,n,f):nt()&&i!==!1&&(i=O(t,n,p)),n===T&&E(t),n===y&&(k?0==t.touches.length&&E(t):E(t)),i}function O(n,c,h){var _=void 0;if(h==u){if(jt.trigger("swipeStatus",[c,Ot||null,Mt||0,Ft||0,Ut]),i.swipeStatus&&(_=i.swipeStatus.call(jt,n,c,Ot||null,Mt||0,Ft||0,Ut),_===!1))return!1;if(c==y&&q()){if(jt.trigger("swipe",[Ot,Mt,Ft,Ut]),i.swipe&&(_=i.swipe.call(jt,n,Ot,Mt,Ft,Ut),_===!1))return!1;switch(Ot){case e:jt.trigger("swipeLeft",[Ot,Mt,Ft,Ut]),i.swipeLeft&&(_=i.swipeLeft.call(jt,n,Ot,Mt,Ft,Ut));break;case o:jt.trigger("swipeRight",[Ot,Mt,Ft,Ut]),i.swipeRight&&(_=i.swipeRight.call(jt,n,Ot,Mt,Ft,Ut));break;case s:jt.trigger("swipeUp",[Ot,Mt,Ft,Ut]),i.swipeUp&&(_=i.swipeUp.call(jt,n,Ot,Mt,Ft,Ut));break;case a:jt.trigger("swipeDown",[Ot,Mt,Ft,Ut]),i.swipeDown&&(_=i.swipeDown.call(jt,n,Ot,Mt,Ft,Ut))}}}if(h==d){if(jt.trigger("pinchStatus",[c,Qt||null,Rt||0,Ft||0,Ut,Lt]),i.pinchStatus&&(_=i.pinchStatus.call(jt,n,c,Qt||null,Rt||0,Ft||0,Ut,Lt),_===!1))return!1;if(c==y&&Q())switch(Qt){case r:jt.trigger("pinchIn",[Qt||null,Rt||0,Ft||0,Ut,Lt]),i.pinchIn&&(_=i.pinchIn.call(jt,n,Qt||null,Rt||0,Ft||0,Ut,Lt));break;case l:jt.trigger("pinchOut",[Qt||null,Rt||0,Ft||0,Ut,Lt]),i.pinchOut&&(_=i.pinchOut.call(jt,n,Qt||null,Rt||0,Ft||0,Ut,Lt))}}return h==p?c!==T&&c!==y||(clearTimeout(Gt),W()&&!Z()?(Vt=kt(),Gt=setTimeout(t.proxy(function(){Vt=null,jt.trigger("tap",[n.target]),i.tap&&(_=i.tap.call(jt,n,n.target))},this),i.doubleTapThreshold)):(Vt=null,jt.trigger("tap",[n.target]),i.tap&&(_=i.tap.call(jt,n,n.target)))):h==g?c!==T&&c!==y||(clearTimeout(Gt),Vt=null,jt.trigger("doubletap",[n.target]),i.doubleTap&&(_=i.doubleTap.call(jt,n,n.target))):h==f&&(c!==T&&c!==y||(clearTimeout(Gt),Vt=null,jt.trigger("longtap",[n.target]),i.longTap&&(_=i.longTap.call(jt,n,n.target)))),_}function F(){var t=!0;return null!==i.threshold&&(t=Mt>=i.threshold),t}function H(){var t=!1;return null!==i.cancelThreshold&&null!==Ot&&(t=gt(Ot)-Mt>=i.cancelThreshold),t}function A(){return null===i.pinchThreshold||Rt>=i.pinchThreshold}function L(){var t;return t=!i.maxTimeThreshold||!(Ft>=i.maxTimeThreshold)}function R(t,n){if(i.allowPageScroll===c||N())t.preventDefault();else{var r=i.allowPageScroll===h;switch(n){case e:(i.swipeLeft&&r||!r&&i.allowPageScroll!=_)&&t.preventDefault();break;case o:(i.swipeRight&&r||!r&&i.allowPageScroll!=_)&&t.preventDefault();break;case s:(i.swipeUp&&r||!r&&i.allowPageScroll!=m)&&t.preventDefault();break;case a:(i.swipeDown&&r||!r&&i.allowPageScroll!=m)&&t.preventDefault()}}}function Q(){var t=X(),n=Y(),i=A();return t&&n&&i}function N(){return!!(i.pinchStatus||i.pinchIn||i.pinchOut)}function j(){return!(!Q()||!N())}function q(){var t=L(),n=F(),i=X(),e=Y(),o=H(),s=!o&&e&&i&&n&&t;return s}function U(){return!!(i.swipe||i.swipeStatus||i.swipeLeft||i.swipeRight||i.swipeUp||i.swipeDown)}function K(){return!(!q()||!U())}function X(){return Ut===i.fingers||i.fingers===v||!k}function Y(){return 0!==Kt[0].end.x}function B(){return!!i.tap}function W(){return!!i.doubleTap}function V(){return!!i.longTap}function G(){if(null==Vt)return!1;var t=kt();return W()&&t-Vt<=i.doubleTapThreshold}function Z(){return G()}function J(){return(1===Ut||!k)&&(isNaN(Mt)||0===Mt)}function tt(){return Ft>i.longTapThreshold&&Mt<w}function nt(){return!(!J()||!B())}function it(){return!(!G()||!W())}function et(){return!(!tt()||!V())}function ot(){Bt=kt(),Wt=event.touches.length+1}function st(){Bt=0,Wt=0}function at(){var t=!1;if(Bt){var n=kt()-Bt;n<=i.fingerReleaseThreshold&&(t=!0)}return t}function rt(){return!(jt.data(S+"_intouch")!==!0)}function lt(t){t===!0?(jt.bind(Et,D),jt.bind(It,$),Pt&&jt.bind(Pt,I)):(jt.unbind(Et,D,!1),jt.unbind(It,$,!1),Pt&&jt.unbind(Pt,I,!1)),jt.data(S+"_intouch",t===!0)}function ct(t,n){var i=void 0!==n.identifier?n.identifier:0;return Kt[t].identifier=i,Kt[t].start.x=Kt[t].end.x=n.pageX||n.clientX,Kt[t].start.y=Kt[t].end.y=n.pageY||n.clientY,Kt[t]}function ht(t){var n=void 0!==t.identifier?t.identifier:0,i=ut(n);return i.end.x=t.pageX||t.clientX,i.end.y=t.pageY||t.clientY,i}function ut(t){for(var n=0;n<Kt.length;n++)if(Kt[n].identifier==t)return Kt[n]}function dt(){for(var t=[],n=0;n<=5;n++)t.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return t}function pt(t,n){n=Math.max(n,gt(t)),Nt[t].distance=n}function gt(t){if(Nt[t])return Nt[t].distance}function ft(){var t={};return t[e]=_t(e),t[o]=_t(o),t[s]=_t(s),t[a]=_t(a),t}function _t(t){return{direction:t,distance:0}}function mt(){return Yt-Xt}function vt(t,n){var i=Math.abs(t.x-n.x),e=Math.abs(t.y-n.y);return Math.round(Math.sqrt(i*i+e*e))}function wt(t,n){var i=n/t*1;return i.toFixed(2)}function xt(){return Lt<1?l:r}function bt(t,n){return Math.round(Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2)))}function yt(t,n){var i=t.x-n.x,e=n.y-t.y,o=Math.atan2(e,i),s=Math.round(180*o/Math.PI);return s<0&&(s=360-Math.abs(s)),s}function Tt(t,n){var i=yt(t,n);return i<=45&&i>=0?e:i<=360&&i>=315?e:i>=135&&i<=225?o:i>45&&i<135?a:s}function kt(){var t=new Date;return t.getTime()}function St(n){n=t(n);var i=n.offset(),e={left:i.left,right:i.left+n.outerWidth(),top:i.top,bottom:i.top+n.outerHeight()};return e}function Ct(t,n){return t.x>n.left&&t.x<n.right&&t.y>n.top&&t.y<n.bottom}var Dt=k||!i.fallbackToMouseEvents,$t=Dt?"touchstart":"mousedown",Et=Dt?"touchmove":"mousemove",It=Dt?"touchend":"mouseup",Pt=Dt?null:"mouseleave",zt="touchcancel",Mt=0,Ot=null,Ft=0,Ht=0,At=0,Lt=1,Rt=0,Qt=0,Nt=null,jt=t(n),qt="start",Ut=0,Kt=null,Xt=0,Yt=0,Bt=0,Wt=0,Vt=0,Gt=null;try{jt.bind($t,C),jt.bind(zt,E)}catch(n){t.error("events not supported "+$t+","+zt+" on jQuery.swipe")}this.enable=function(){return jt.bind($t,C),jt.bind(zt,E),jt},this.disable=function(){return P(),jt},this.destroy=function(){return P(),jt.data(S,null),jt},this.option=function(n,e){if(void 0!==i[n]){if(void 0===e)return i[n];i[n]=e}else t.error("Option "+n+" does not exist on jQuery.swipe.options");return null}}var e="left",o="right",s="up",a="down",r="in",l="out",c="none",h="auto",u="swipe",d="pinch",p="tap",g="doubletap",f="longtap",_="horizontal",m="vertical",v="all",w=10,x="start",b="move",y="end",T="cancel",k="ontouchstart"in window,S="TouchSwipe",C={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe"};t.fn.swipe=function(i){var e=t(this),o=e.data(S);if(o&&"string"==typeof i){if(o[i])return o[i].apply(this,Array.prototype.slice.call(arguments,1));t.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(o||"object"!=typeof i&&i))return n.apply(this,arguments);return e},t.fn.swipe.defaults=C,t.fn.swipe.phases={PHASE_START:x,PHASE_MOVE:b,PHASE_END:y,PHASE_CANCEL:T},t.fn.swipe.directions={LEFT:e,RIGHT:o,UP:s,DOWN:a,IN:r,OUT:l},t.fn.swipe.pageScroll={NONE:c,HORIZONTAL:_,VERTICAL:m,AUTO:h},t.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:v}});var _ns={},_handles="fullscreen item itemnext contentclick contentmouseover contentmousemove contentmouseout dataloaded hasloaded waiting transition transitionstart transitionend playing built playbacktimer resizecomplete ended start ready videobegin videoend";_bind=function(t){var n=this;_handles.indexOf(t.type)<0||this.contentContainer.bind(t.type,function(i,e){if(i="boolean"==typeof e||e instanceof Array?e:$.extend({},i,e),t.type==n.triggered){if(!t.fn)return;if("transition"===t.type)t.fn.call(n.container,{current:n.last,next:n.current,forward:n.forward},t.type);else if("playing"===t.type)t.fn.call(n.container,"playing"===n.state,t.type);else{if(i.nodeType&&"transitionend"===t.type)return;t.fn.call(n.container,i.nodeType?$(i):i,t.type)}}})},_queue=function(t){t=t||!1;var n=[],i=this;return{add:function(t){return n.push(t),this},load:function(){for(var e=n.length,o=0;o<e;o++){var s=n[o],a=s.priority||i.loadQueue.internal.length;delete s.priority,t?(s.node.bind("load",function(){_popQueue.call(i)}),i.loadQueue.external.push(s)):1===a?i.loadQueue.internal.unshift(s):i.loadQueue.internal.splice(a,0,s)}n=[],_popQueue.call(i)}}},_popQueue=function(){var t=this.loadQueue.internal.shift();if(!t){if(!this.loadQueue.canLoadExternal)return;t=this.loadQueue.external.shift()}t?t.node?t.node.attr("src",t.src):_popQueue.call(this):(clearInterval(this.loadQueue.interval),this.loadQueue.interval=!1)},_hasLoaded=function(t){var n,i=t.parent("div.pulse-content-container");i.length&&i.data("asset")&&(n=i.data("asset").index),t.addClass("loaded"),n!==this.options.index||0!=i.parent("div").css("opacity")&&!this.options.touchSwipe||(this.contentContainer.trigger(this.triggered="waiting",[!1]),_display.call(this)),this.contentContainer.trigger(this.triggered="hasloaded"),_popQueue.call(this)},_loadItemById=function(t){var n=this.idMap[t];_loadItemByIndex(n)},_loadItemByIndex=function(t,n){n=n||!1,n||_pause.call(this),t<this.options.index?t=-(this.options.index-t):t-=this.options.index,_update.call(this,t,n)},_get=function(t){return this.contentContainer.find('div[data-pulse-container="'+t+'"]')},_pause=function(){this.state="paused",clearTimeout(this.playTimer.id),this.contentContainer.trigger(this.triggered="playing")},_play=function(){this.state="playing",_update.call(this,1),this.contentContainer.trigger(this.triggered="playing")},_options=function(){return this.options},_toggle=function(t,n){this.firstTime=!1,"playing"==this.state?_pause.call(this):_play.call(this)},_toggleFullScreen=function(){var t=Pulse.fullScreenApi;if(t.isFullScreen())this.lastHeight&&this.contentContainer.css("height",this.lastHeight),t.cancelFullScreen(),this.contentContainer.trigger(this.triggered="fullscreen",[!1]);else{this.lastHeight=this.contentContainer.css("height");var n=this.container.children(":not(.pulse-main-container)").height();this.contentContainer.css("height","-webkit-calc(100% - "+n+"px)"),this.contentContainer.css("height","-moz-calc(100% - "+n+"px)"),this.contentContainer.css("height","-ms-calc(100% - "+n+"px)"),this.contentContainer.css("height","-o-calc(100% - "+n+"px)"),this.contentContainer.css("height","calc(100% - "+n+"px)"),t.requestFullScreen(this.options.fullScreenRoot[0]),this.contentContainer.trigger(this.triggered="fullscreen",[!0])}},_startPlaybackTimer=function(){if("undefined"==typeof this.firstTime&&!this.options.autostart)return void(this.firstTime=!1);if("playing"===this.state){var t=this,n=+new Date,i={total:this.options.speed};this.playTimer.remaining=this.playTimer.remaining||this.options.speed,clearInterval(this.playTimer.id),this.playTimer.id=setInterval(function(){var e=+new Date;t.playTimer.remaining-=e-n,n=e,i.remaining=Math.max(t.playTimer.remaining,0),i.totalItems=t.totalItems,t.contentContainer.trigger(t.triggered="playbacktimer",i),t.playTimer.remaining<=0&&_update.call(t,1)},50)}},_exists=function(t){var n=$.inArray(t,this.handlers);return n!==-1&&this.handlers[n]},_loadPreset=function(t,n){n=n||!1;var i,e={width:t.width(),height:t.height()},o=!1,s=t.data("asset"),a={},r=t.find("img.pulse-content-image"),l=Math.max(Math.abs(this.options.index-s.index),1);t.removeClass("loaded");for(var c in s.presets)if(i=s.presets[c],"expand"===this.options.size&&i.width>e.width||i.width>e.width&&i.height>e.height){o=window.$K&&$K.isRetina()?i.hidpi_url:i.url,a.width=i.width,a.height=i.height;break}o||(o=$K.isRetina()?i.hidpi_url:i.url),this.options.relative&&s.cache_path.relative_prefix&&0===o.indexOf("http")&&(o=o.replace(s.cache_path.prefix,s.cache_path.relative_prefix)),t.data("size",a);var h={node:r,src:o,priority:l};return n?void _queue.call(this).add(h).load():h},_load=function(){var t,n,e=[this.loaded[this.options.index].id],o=this,s=this.touchContainer||this.contentContainer;for(i=1;i<=this.cushion;i++)t=this.options.index-i,t<0&&(t=this.loaded.length+t),this.loaded[t]&&(_get.call(this,this.loaded[t].id).length<=0&&s.append(_build.call(this,t)),e.push(this.loaded[t].id));for(_get.call(this,this.loaded[this.options.index].id).length<=0&&s.append(_build.call(this,this.options.index)),i=1;i<=this.cushion;i++)n=this.options.index+i,n>=this.loaded.length&&(n-=this.loaded.length),this.loaded[n]&&(_get.call(this,this.loaded[n].id).length<=0&&s.append(_build.call(this,n)),e.push(this.loaded[n].id));var a=_queue.call(this);this.contentContainer.find("div.pulse-content-container").each(function(){var t=$(this),n=t.find("img.pulse-content-image"),i=t.data("asset"),s=t.parent(),r=i&&i.id;$.inArray(r,e)===-1?(n.attr("src",""),s.remove()):n.hasClass("loaded")||a.add(_loadPreset.call(o,t))}),a.load()},_ratio=function(t,n){n&&(this.realDims={width:t.parents("div").width(),height:t.parents("div").height()},t=t.data("asset"));var i="expand"!==this.options.size||this.options.maxHeight===1/0?this.realDims.height:this.options.maxHeight;return this.containerRatio=this.containerRatio&&this.containerRatio<1/0?this.containerRatio:this.realDims.width/i,t.aspect_ratio>=this.containerRatio?{w:this.realDims.width,h:Math.round(this.realDims.width/t.aspect_ratio)}:{w:Math.round(i*t.aspect_ratio),h:i}},_kill=function(){this.dead=!0,this.contentContainer.off(),this.state="paused",clearInterval(this.loadQueue.interval),clearTimeout(this.playTimer.id);var t=this.container.attr("id");delete _ns[t],$.each(_ns.all,function(n,i){i&&i.container.attr("id")===t&&_ns.all.splice(n,1)})},_update=function(t,n){if(n=n||!1,!this.transitioning){var i=parseInt(this.options.index,10)+t;if(clearInterval(this.playTimer.id),this.playTimer.remaining=!1,t<0&&!n?(_pause.call(this),this.forward=!1):this.forward=!0,this.loaded.length<=1||this.options&&this.options.loop===!1&&i>=this.loaded.length)return void this.contentContainer.trigger(this.triggered="ended");this.options.index=i<0?this.loaded.length-1:i>=this.loaded.length?0:i;var e=_get.call(this,this.loaded[this.options.index].id);e.length?e.find("img.pulse-content-image").hasClass("loaded")?_display.call(this):(this.contentContainer.trigger(this.triggered="waiting",[!0]),_loadPreset.call(this,e.find("div.pulse-content-container"),!0)):(this.contentContainer.trigger(this.triggered="waiting",[!0]),e=_build.call(this,this.options.index),this.contentContainer.append(e),_loadPreset.call(this,e.find("div.pulse-content-container"),!0))}},_getItem=function(){return this.currentData},_getNextItem=function(){var t=this.options.index+1;return t>=this.loaded.length&&this.options.loop===!0&&(t=0),this.loaded[t]||!1},_display=function(){if(this.transitioning=!0,this.current&&this.current.css("z-index",9),this.currentData=this.loaded[this.options.index],this.current=_get.call(this,this.currentData.id),"expand"===this.options.size){var t=Math.min(this.options.maxHeight,this.realDims.width/this.currentData.aspect_ratio);this.contentContainer.animate({height:t},0===this.realDims.height||"none"===this.options.transition_type?0:this.options.transition_duration),this.realDims.height=t}if(this.current.css("z-index",10),this.last?(this.last.find(".video-container").css({left:-1e4}),this.last.find("img.pulse-content-image").show()):this.options.autostart===!0&&(this.state="playing",this.contentContainer.trigger(this.triggered="playing")),this.contentContainer.trigger(this.triggered="transitionstart",{dom:this.current,data:this.currentData}),this.contentContainer.trigger(this.triggered="itemnext",{dom:this.current,data:this.currentData}),this.options.next&&!this.options.loop){var n=$(this.options.next);n.length&&(this.currentData.is_last?n.addClass("k-pulse-button-disabled"):n.removeClass("k-pulse-button-disabled"))}if(this.options.previous&&!this.options.loop){var i=$(this.options.previous);i.length&&(this.currentData.is_first?i.addClass("k-pulse-button-disabled"):i.removeClass("k-pulse-button-disabled"))}this.loadQueue.canLoadExternal=!0,this.contentContainer.trigger(this.triggered="transition",this.current),this.last=this.current;var e=this.current.find(".video-container");e.length&&this.currentData.html&&e.css("left","50%")},_build=function(t){var n=this.loaded[t],i=$('<div data-pulse-container="'+n.id+'" />'),e=$("<div />"),o=$("<div />").addClass("pulse-content-ui-container").css("position","absolute"),s=$("<img />").addClass("pulse-content-image"),a=this;n.index=t,n.position=t+1,n.total=this.totalItems,n.is_first=1===n.position,n.is_last=n.position===this.totalItems,i.css({position:"absolute",background:this.options.background,width:"100%",height:"100%",top:0,left:0,right:"auto",bottom:"auto",opacity:0,margin:0,padding:0,border:0,overflow:"hidden",zIndex:9});var r=_position.call(this,n);if(e.addClass("pulse-content-container").css({position:"absolute",width:r.width,height:r.height,left:r.left,top:r.top}).data("asset",n),r.cropped?o.css({width:a.container.width(),height:a.container.height(),top:-r.top,left:-r.left}):o.css({width:"100%",height:"100%"}),s.attr({alt:n.title||n.filename,width:"100%",height:"100%","data-longest-side":Math.max(n.width,n.height),"data-visibility":n.visibility.raw}).css({position:"absolute",top:0,left:0}).one("load",function(){_hasLoaded.call(a,$(this))}),e.append(s),"video"===n.file_type){var l;n.html?(l=$(n.pulse_html||n.html),l.attr({width:"100%",height:"100%"}).css({position:"absolute",top:0,left:0}).appendTo(e)):l=$("<video/>").css({position:"absolute",top:0,left:0,width:"100%",height:"100%"}).attr({width:"100%",height:"100%",src:n.original.url});var c=$("<div/>").addClass("video-container").css({position:"absolute",top:"50%",left:"-10000px",width:n.html?"80px":"100%",height:n.html?"80px":"100%",margin:n.html?"-40px 0 0 -40px":0,opacity:.001,zIndex:n.html?1e4:1});c.append(l),e.append(c);var h=$("<div/>").addClass("video-overlay").css({position:"absolute",top:0,left:0,width:"100%",height:"100%",display:n.html?"none":"block",zIndex:2}).append($("<div/>").addClass("mejs-overlay-button").bind("click touchstart",function(t){t.preventDefault(),t.stopPropagation(),c.data("player")&&c.data("player").play(),_crop.call(a,n.aspect_ratio)&&e.find(".mejs-controls").css({width:i.width(),left:Math.abs(a.realDims.width/2-i.find(".pulse-content-container").width()/2)});var o=a.container.attr("id");_ns[o].triggers.videoStart.call(a)}));e.append(h),n.html||requestAnimationFrame(function(){$(l).mediaelementplayer({pluginPath:$K.location.real_root_folder+"/app/site/themes/common/js/",success:function(t){c.data("player",t);var n=a.container.attr("id");t.addEventListener("ended",function(){_ns[n].triggers.videoEnd.call(a)}),t.addEventListener("pause",function(){_ns[n].triggers.videoPause.call(a)})}})})}return e.append(o),i.append(e),this.contentContainer.trigger(this.triggered="built",{dom:i,data:n}),i},_data=function(t){t=t||!1;var n=function(t){function n(t){for(var n=t.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1)),e=t[n];t[n]=t[i],t[i]=e}return t}var i=t.album||!1;if(!t.content)if(t.covers)t.content=t.covers;else{if(!t.albums)return;"random"===this.options.order&&(t.albums=n(t.albums));var e=[];i=[],$.each(t.albums,function(t,n){e.push(n.covers[0]),i.push(n)}),t.content=e}if("random"!==this.options.order||t.albums||(t.content=n(t.content)),this.options.index>t.total-1&&(this.options.index=0),0===t.total)return this.contentContainer.trigger(this.triggered="dataloaded",{items:!1,source:t.site_link||!1}),void(this.options.fallbackText?(this.container.html('<span class="k-note k-note-pulse" style="display:block;">'+this.options.fallbackText+"</span>"),this.container.get(0).style.height.length&&this.container.find(".k-note").css("line-height",this.container.outerHeight(!0)+"px"),this.container.addClass("k-pulse-no-data")):this.options.fallbackElement&&(this.container.hide(),this.options.fallbackElement.show()));var o=!1,s=!1;0===this.totalItems&&((t.album||t.albums)&&(this.options.can_link_to_album=!0),"album"===this.options.link_to&&t.album&&(this.options.link_to=t.album.__koken_url),"album"===this.options.link_to&&t.albums&&(this.originalData=t,this.options.link_to="albums"),this.options.dataUrl.match(/limit:[0-9]+/)?(s=!0,this.totalItems=t.content.count):this.totalItems=t.total,this.cushion=Math.max(this.totalItems<2*this.cushion+1?Math.floor((this.totalItems-.5)/2):this.cushion,1),o=!0);var a,r;for(a=0,r=t.content.length;a<r;a++)if(t.content[a].presets){var l=t.content[a];$.isArray(i)?l.parent=i[a]:l.parent=i,this.loaded.push(l),this.idMap[t.content[a].id]=this.loaded.length-1}if("auto"===this.options.size){var c=0,h=0;$.each(t.content,function(t,n){isNaN(n.aspect_ratio)||(c+=n.aspect_ratio,h++)});var u,d=c/h,p=1/0,g=["1:10","2:10","3:10","4:10","5:10","6:10","7:10","8:10","9:10","10:10","10:9","10:8","10:7","10:6","10:5","10:4","10:3","10:2","10:1","4:3","3:4","3:2","2:3","1:1","16:9"];$.each(g,function(t,n){var i=n.split(":"),e=i[0]/i[1],o=Math.abs(d-e);o<p&&(u=n,p=o)}),this.options.size=u,_setSize.call(this),_resize.call(this)}this.contentContainer.trigger(this.triggered="dataloaded",{items:t.content,source:t.site_link||!1}),o&&(this.options.album_type=t.album?t.album.album_type:!!t.album_type&&t.album_type,this.options.album_id=t.album?t.album.id:!!t.id&&t.id,this.contentContainer.trigger(this.triggered="waiting",[!0]),_load.call(this),this.contentContainer.trigger(this.triggered="ready",this.container)),t.page<t.pages&&!s&&(this.options.dataUrl=this.options.dataUrl.replace(/\/page:[0-9]+/,"")+"/page:"+(t.page+1),_data.call(this))};if(t)n.call(this,t);else{var i=this;$.ajax({url:this.options.dataUrl,dataType:"json",success:function(t){n.call(i,t)}})}},_event=function(t,n,i,e){var o=this;$(document).on(n,t,{},function(t){this.forward=!(e<0),i.call(o,e,t),t.preventDefault()})},_resizePresets=function(){var t=_queue.call(this),n=this;this.contentContainer.find("div.pulse-content-container").each(function(){var i=$(this),e=i.data("size");"object"==typeof e&&(n.realDims.width>e.width||n.realDims.height>e.height)&&t.add(_loadPreset.call(n,i))}),t.load()},_position=function(t){0===this.realDims.height&&this.options.height&&this.options.height.indexOf("%")!==-1&&_resize.call(this);var n,i,e=this.realDims.width,o="expand"!==this.options.size||this.options.maxHeight===1/0?this.realDims.height:this.options.maxHeight,s=Math.round(e/t.aspect_ratio),a=_crop.call(this,t.aspect_ratio);if(a)s<o&&(s=o,e=Math.round(s*t.aspect_ratio)),i=Math.min(0,Math.max(-(e-this.realDims.width),this.realDims.width/2-e/(100/t.focal_point.x))),n=Math.min(0,Math.max(-(s-o),o/2-s/(100/t.focal_point.y)));else if("expand"!==this.options.size||s>this.options.maxHeight){o="expand"===this.options.size?this.options.maxHeight:o;var r=_ratio.call(this,t);e=r.w,s=r.h,i=this.realDims.width/2-e/2,n=o/2-s/2}return{width:e,height:s,left:i,top:n,cropped:a}},_crop=function(t){var n=t<1,i=this.containerRatio<1;return"fill"===this.options.crop||"adaptive"===this.options.crop&&n===i||"portrait"===this.options.crop&&n||"landscape"===this.options.crop&&!n},_resize=function(){if(!this.dead){var t=this;if(this.options.autoHeight&&this.contentContainer.css({height:this.container.width()*this.options.autoHeight}),this.options.maxHeightAuto&&(this.options.maxHeight=this.container.width()),"expand"===this.options.size){if(!this.currentData)return;this.contentContainer.css("height",Math.min(this.options.maxHeight,this.container.width()/this.currentData.aspect_ratio))}if(this.realDims={width:this.contentContainer.width(),height:this.contentContainer.height()},0===this.realDims.width&&Pulse.fullScreenApi.isFullScreen())return this.options.fullScreenRoot.css("width","100%"),void _resize.call(this);this.containerRatio=this.realDims.width/this.realDims.height,this.options.width.toString().indexOf("%")===-1&&this.options.height.toString().indexOf("%")===-1||(window.clearTimeout(this.resizeInterval),this.resizeInterval=window.setTimeout(function(){_resizePresets.call(t)},500)),this.contentContainer.find("div.pulse-content-container").each(function(){var n=$(this);if(n.data("asset")){var i=_position.call(t,n.data("asset"));n.css({width:i.width,height:i.height,left:i.left,top:i.top});var e=n.find("video");e.length&&e[0].player&&(e=e[0].player,e.setPlayerSize(i.width,i.height),e.setControlsSize(),"native"!==e.pluginType&&e.media.setVideoSize&&e.media.setVideoSize(i.width,i.height),_crop.call(t,n.data("asset").aspect_ratio)&&n.find(".mejs-controls").css({width:t.realDims.width,left:Math.abs(i.left)}));var o=n.find(".pulse-content-ui-container");i.cropped?o.css({width:t.container.width(),height:t.container.height(),top:-i.top,left:-i.left}):o.css({width:"100%",height:"100%"})}});var n=this.container.find(".k-note");n.length&&n.outerHeight()!==this.container.height()&&n.css("line-height",this.container.height()+"px")}},_clone=function(t){if(!t)return!1;var n=$(t[0].cloneNode(!0));return n.find("[data-node-uid]").removeAttr("data-node-uid"),n},_setSize=function(){var t="auto"===this.options.size?"3:2":this.options.size,n=t.split(":");this.options.height=n[1]+"/"+n[0];var i,e=this.options.height.split("/"),o=e[0]/e[1];return i=isNaN(this.options.width)?this.container.parent().width()*o:this.options.width*o,this.options.autoHeight=o,i},_setup=function(t,n){var i=$(t),e=i.attr("id");if(_ns[e]={},_ns[e].context=i,_ns[e].container=i,_ns[e].dead=!1,_ns[e].parent=i.parent(),_ns[e].platform=window.onorientationchange?4:10,_ns[e].handlers=[],_ns[e].loaded=[],_ns[e].triggers=[],_ns[e].touch={},_ns[e].playTimer={id:0,remaining:!1},_ns[e].cushion=3,_ns[e].realDims={},_ns[e].forward=!0,_ns[e].transitioning=!1,_ns[e].touch={},_ns[e].totalItems=0,_ns[e].idMap={},_ns[e].loadQueue={internal:[],external:[],canLoadExternal:!1,interval:!1},_ns[e].stack=0,_ns[e].fsElWidth=0,_ns[e].options={},_ns[e].options.album_id=!1,_ns[e].options.album_type=!1,_ns[e].options.width=n&&n.width?n.width:"100%",_ns[e].options.height=!(!n||!n.height)&&n.height,_ns[e].options.background=n&&n.background||_ns[e].container.css("background"),_ns[e].options.speed=1e3*(n&&n.speed||5),_ns[e].options.index=n&&n.index||0,_ns[e].options.crop=n&&n.crop||"none",_ns[e].options.dataUrl=n&&n.dataUrl||"/api.php?/content",_ns[e].options.autoHeight=!1,_ns[e].options.size=n&&n.size&&("auto"===n.size||"expand"===n.size||n.size.indexOf(":")>0)&&n.size||!1,_ns[e].options.maxHeight=parseInt(i.css("max-height"),10),_ns[e].options.maxHeightAuto=!1,_ns[e].options.allowFullScreen=!n||!n.hasOwnProperty("allowfullscreen")||n.allowfullscreen,_ns[e].options.fullScreenRoot=n&&n.fullscreenroot&&$(n.fullscreenroot)||_ns[e].container,_ns[e].options.fallbackText=n&&n.fallbacktext||!1,_ns[e].options.fallbackElement=!(!n||!n.fallbackelement)&&$(n.fallbackelement),_ns[e].options.link_to=n&&"false"!==n.link_to&&n.link_to,_ns[e].options.transition_duration=n&&n.transition_duration||"500ms",_ns[e].options.data=n.data||!1,_ns[e].options.order=n&&n.random===!0?"random":"default",_ns[e].options.album_url=n.albumUrl||!1,_ns[e].options.can_link_to_album=n.can_link_to_album||!1,_ns[e].options.touchSwipe=void 0===n.swipe||n.swipe,_ns[e].options.touchSwipe&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)){var o=["Webkit","Moz","O","ms",""],s=!1;o.forEach(function(t,n){if(t+"Transform"in document.body.style)return s=t,!1}),s?(s.length&&(s="-"+s.toLowerCase()+"-"),_ns[e].options.touchSwipePrefix=s):_ns[e].options.touchSwipe=!1}else _ns[e].options.touchSwipe=!1;_ns[e].options.touchSwipe&&(_ns[e].cushion=2),_ns[e].options.transition_duration=function(){var t=_ns[e].options.transition_duration,n=parseFloat(t,10),i=parseInt(t,10);return 0===n?0:(n>0&&i.toString().length<=2&&(t+="s"),/\dms$/.test(t)?parseInt(t,10):/\ds$/.test(t)?1e3*parseFloat(t,10):t)}(),_ns[e].options.link_to&&$.inArray(n.link_to,["lightbox","content","album"])!==-1&&!window.$K&&(_ns[e].options.link_to=!1),isNaN(_ns[e].options.maxHeight)&&(_ns[e].options.maxHeight=i.width(),_ns[e].options.maxHeightAuto=!0),_ns[e].options.size||_ns[e].options.height||(_ns[e].options.size="3:2");var a=_ns[e].options.height;_ns[e].options.size&&"expand"!==_ns[e].options.size&&(a=_setSize.call(_ns[e])),n&&(n.transition_type?_ns[e].options.transition=n.transition_type:_ns[e].options.transition="dissolve",n.transition_easing?_ns[e].options.transition_easing=n.transition_easing:_ns[e].options.transition_easing="ease-in-out","undefined"==typeof n.loop?_ns[e].options.loop=!0:_ns[e].options.loop=n.loop,_ns[e].options.autostart="undefined"==typeof n.autostart||n.autostart,n.next&&_event.call(_ns[e],n.next,"click",function(){!this.options.loop&&this.currentData.is_last||_update.call(this,1)}),n.previous&&_event.call(_ns[e],n.previous,"click",function(){!this.options.loop&&this.currentData.is_first||_update.call(this,-1)}),n.restart&&_event.call(_ns[e],n.restart,"click",function(){_loadItemByIndex.call(this,0,!0)}),n.toggle&&_event.call(_ns[e],n.toggle,"click",_toggle),n.play&&_event.call(_ns[e],n.play,"click",_play),n.pause&&_event.call(_ns[e],n.pause,"click",_pause),n.pause&&_event.call(_ns[e],n.pause,"click",_pause),n.fullscreen&&(Pulse.fullScreenApi.supportsFullScreen?_event.call(_ns[e],n.fullscreen,"click",_toggleFullScreen):$(n.fullscreen).addClass("k-pulse-button-disabled"))),_ns[e].container.css({background:_ns[e].options.background,
position:"relative",width:_ns[e].options.width}),"expand"===_ns[e].options.size?a=0:String(a).indexOf("%")!==-1&&_ns[e].container.css("height",a),_ns[e].contentContainer=$("<div/>").css({width:_ns[e].options.width,height:a,position:"relative"}).attr("class","pulse-main-container"),_ns[e].options.link_to&&_ns[e].contentContainer.css("cursor","pointer");var r=["click","mousedown","mouseover","mousemove","mouseout"];if(_ns[e].options.touchSwipe){var i=_ns[e];_ns[e].contentContainer.css("overflow","hidden"),_ns[e].touchContainer=$("<div/>").css({height:"100%",position:"relative"}).bind("webkitTransitionEnd mozTransitionEnd msTransitionEnd oTransitionEnd transitionend",function(){if($(this).css(i.options.touchSwipePrefix+"transition",""),i.options.transition_duration="500ms",i.transitioning){if(_load.call(i),i.current.css("left",0),$(this).css(i.options.touchSwipePrefix+"transform","translate3d(0,0,0)"),1===i.totalItems)return;for(var t=i.totalItems<5?i.options.index-1:i.options.index-2,n=i.totalItems<5?i.options.index+(i.totalItems-1):i.options.index+3,e=t;e<n;e++)if(e!==i.options.index){var o=e<i.options.index,s=e,a=Math.abs(s-i.options.index);s>=i.loaded.length&&(s-=i.loaded.length),s<0&&(s=i.loaded.length+s);var r=i.loaded[s];r&&_get.call(i,r.id).css({left:(o?"-":"")+100*a+"%",opacity:1})}requestAnimationFrame(function(){i.triggers.transitionEnd.call(i)})}}).attr("class","pulse-touch-container").appendTo(_ns[e].contentContainer);var l={start:{x:0,y:0},end:{x:null,y:null},move:!1};_ns[e].contentContainer.bind("touchstart touchmove touchend",function(t){i.options.transition_duration="500ms";var n=t.originalEvent.targetTouches[0];switch(t.type){case"touchstart":l.start.x=n.pageX,l.start.y=n.pageY,l.start.time=+new Date,l.end.x=null,l.move=!1;break;case"touchmove":l.end.x=n.pageX,l.end.y=n.pageY;var o=l.start.x-l.end.x,s=l.start.y-l.end.y;Math.abs(o/2)>Math.abs(s)&&(clearTimeout(i.playTimer.id),t.stopPropagation(),t.preventDefault(),l.move=!0,i.touchContainer.css(i.options.touchSwipePrefix+"transform","translate3d("+-o+"px,0,0)"));break;case"touchend":if(l.move){t.stopPropagation(),t.preventDefault();var a=l.start.x-l.end.x,r=a<0?-1:1;a=Math.abs(a);var c=i.contentContainer.width(),h=+new Date,u=h-l.start.time,d=u/a,p=c-a;i.options.index+r;a>.07*c&&i.totalItems>1?(i.options.transition_duration=Math.min(500,Math.round(p*d))+"ms",_update.call(i,r)):_display.call(i)}else null===l.end.x&&(t.stopPropagation(),t.preventDefault(),_ns[e].contentContainer.trigger("click"))}})}else _ns[e].contentContainer.swipe({swipe:function(t,n,i,e,o){var s=_ns[$(t.target).closest(".pulse-content-container").closest(".pulse-main-container").parent().attr("id")];"left"===n?_update.call(s,1):"right"===n&&_update.call(s,-1)},allowPageScroll:"vertical"}),r.concat(["touchstart","touchmove","touchend"]);return _ns[e].contentContainer.bind(r.join(" "),function(t){if("mousedown"===t.type){if($.inArray(t.target.tagName.toLowerCase(),["embed","object","video"])===-1)return;t.type="click"}var n=$(t.target),i=!1;if(n.hasClass("pulse-main-container")?i=n:n.closest(".pulse-content-container").closest(".pulse-main-container").parent().length>0&&(i=n.closest(".pulse-content-container").closest(".pulse-main-container")),i){var e=_ns[i.parent().attr("id")],o=_exists.call(e,"content"+t.type);if(o){var s={dom:e.current,data:e.currentData};if(t.type.indexOf("touch")===-1){var a=e.contentContainer.offset(),r=t.pageX-a.left,l=a.top-t.pageY;s.cursor={percentageX:Math.abs(Math.round(100*(r/e.contentContainer.width()).toFixed(2))),percentageY:Math.abs(Math.round(100*(l/e.contentContainer.height()).toFixed(2)))}}e.contentContainer.trigger(e.triggered="content"+t.type,s)}if("click"===t.type&&e.options.link_to){var c,h=(e.options.dataUrl,!1);!!window.$K&&window.$K.location.defaults;if(e.options.data&&e.options.data.album_id?h=e.options.data.album_id:e.options.album_id&&(h=e.options.album_id),t.originalEvent&&"video"===t.originalEvent.target.tagName.toLowerCase())return;var u=location.href.match(/&preview=.*/)||"";switch(e.options.link_to){case"advance":return void _update.call(e,1);case"playback":return void _toggle.call(e);case"lightbox":case"content":if(c=e.currentData.__koken_url,"lightbox"===e.options.link_to&&!/\/lightbox\/$/.test(c))return c=$K.location.root+c+"lightbox/"+u,_pause.call(e),void $K.lightbox.load(c);break;case"albums":c=e.originalData.albums[e.options.index].__koken_url;break;case"album":var d=RegExp(e.options.album_url.replace(/:[a-z_]+/,"[^/]+"));c=!(!e.currentData.__koken_url||!d.test(e.currentData.__koken_url))&&e.currentData.__koken_url.match(d)[0];break;default:c=e.options.link_to}c&&(t.preventDefault(),location.href=(c.indexOf("http://")===-1?window.$K.location.root:"")+c+(c.indexOf("http://")===-1?u:""))}}}),_ns[e].container.append(_ns[e].contentContainer),_ns[e].realDims={width:_ns[e].contentContainer.width(),height:_ns[e].contentContainer.height()},$(window).bind("orientationchange resize webkitfullscreenchange mozfullscreenchange fullscreenchange",function(t){(!_ns.all||_ns.all.length<$(".pulse-main-container").length)&&(_ns.all=[],$(".pulse-main-container").each(function(t,n){_ns.all.push(_ns[$(n).parent().attr("id")])}));for(var n=0,i=_ns.all.length;n<i;n++){var e,o=_ns.all[n];if(e&&clearTimeout(e),!o)return;e=setTimeout(function(){o.contentContainer.trigger(o.triggered="resizecomplete")},200),_resize.call(o)}}).trigger("resize"),_ns[e].triggers={},_ns[e].triggers.play=function(){_play.call(this)},_ns[e].triggers.pause=function(){_pause.call(this)},_ns[e].triggers.toggle=function(){_toggle.call(this)},_ns[e].triggers.toggleFullScreen=function(){_toggleFullScreen.call(this)},_ns[e].triggers.transitionEnd=function(){this.transitioning=!1,this.options.touchSwipe||_load.call(this),_startPlaybackTimer.call(this),this.contentContainer.trigger(this.triggered="transitionend",{dom:this.current,data:this.currentData}),this.contentContainer.trigger(this.triggered="item",{dom:this.current,data:this.currentData})},_ns[e].triggers.videoReady=function(){this.current.find(".video-overlay").show()},_ns[e].triggers.videoStart=function(){this.current.find(".video-overlay").hide(),_pause.call(this),this.current.find(".video-container").css({left:0,top:0,margin:0,width:"100%",height:"100%",opacity:1}).data("resume","playing"===this.state),this.contentContainer.trigger(this.triggered="videobegin")},_ns[e].triggers.videoPause=function(){this.current.find(".video-overlay").show(),this.currentData.html?this.current.find(".video-container").css({top:"50%",left:"50%",width:"50px",height:"50px",margin:"-25px 0 0 -25px",opacity:.001}):this.current.find(".video-container").css("left",-1e4),this.contentContainer.trigger(this.triggered="videopause")},_ns[e].triggers.videoEnd=function(){this.current.find(".video-container").data("resume")&&(_update.call(this,1),this.state="playing"),this.contentContainer.trigger(this.triggered="videoend")},n&&$.each(n,function(t,n){_ns[e].options.hasOwnProperty(t)||(_ns[e].options[t]=n)}),_ns[e]},P.init=function(t,n){var i=_setup(t,n),e={context:i.context,options:$.extend({},i.options),on:function(t,n){var e=[];return $.each(t.split(" "),function(t,n){RegExp("^|\\s"+n+"\\s|$").test(_handles)&&e.push(n)}),e.length&&$.each(e,function(t,e){i.handlers.push(e),_bind.call(i,{type:e,fn:n})}),this},off:function(t){i.container.unlisten(t)},kill:function(){_kill.call(i)},play:function(){_play.call(i)},pause:function(){_pause.call(i)},next:function(){_update.call(i,1)},options:function(){return _options.call(i)},previous:function(){_update.call(i,-1)},toggle:function(){_toggle.call(i)},toggleFullscreen:function(){Pulse.fullScreenApi.supportsFullScreen&&_toggleFullScreen.call(i)},loadItem:function(t){_loadItemById.call(i,t)},loadItemAtPosition:function(t){_loadItemByIndex.call(i,t)},restart:function(t){_loadItemByIndex.call(i,0,!0)},getItem:function(){return _getItem.call(i)},getNextItem:function(){return _getNextItem.call(i)},trigger:function(t){if(!i.dead)return i.triggers[t]?i.triggers[t].call(i):i.contentContainer.trigger(i.triggered=t,i.contentContainer),this},ratio:function(t){return _ratio.call(i,t,!0)},append:function(t){t.css("position").length<=0&&t.css("position","relative"),t.css("zIndex",12),this.context.find(".pulse-main-container").append(t)},queue:function(){return _queue.call(i,!0)},clone:function(t){return _clone.call(i,t)}};i.options.touchSwipe?(Pulse.transitions._swipe.call(e,i.options),i.options.transition_duration="500ms"):Pulse.transitions[i.options.transition]?Pulse.transitions[i.options.transition].call(e,i.options):Pulse.transitions.dissolve.call(e,i.options);for(var o in window.Pulse.plugin)e[o]=window.Pulse.plugin[o];return $(function(){if(i.contentContainer.trigger(i.triggered="start",i.container),i.options.data&&i.options.data.content){var t={content:i.options.data.content,total:i.options.data.content.length,page:1,pages:1};_data.call(i,t)}else _data.call(i)}),e}}return P.init}.call({});window.Pulse.plugin={},window.Pulse.transitions={_swipe:function(t){var n=!1;this.on("transition",function(i){var e,o=i.next.parents(".pulse-touch-container");i.current&&i.next.attr("data-pulse-container")===i.current.attr("data-pulse-container")?(e=0,t.transition_duration="200ms"):e=o.width(),n||(i.next.css({left:e,opacity:1}),t.transition_duration="1ms",n=!0),i.forward&&(e=-e),o.css(t.touchSwipePrefix+"transition",t.touchSwipePrefix+"transform "+t.transition_duration+" ease-out"),requestAnimationFrame(function(){o.css(t.touchSwipePrefix+"transform","translate3d("+e+"px,0,0)")})})},none:function(t){var n=this;this.on("transition",function(t){t.current&&t.current.css({opacity:0}),t.next.css({opacity:1}),n.trigger("transitionEnd")})},dissolve:function(t){var n=this;this.on("transition",function(i){i.current&&i.current.animate({opacity:0},{duration:t.transition_duration}),i.next.animate({opacity:1},{duration:t.transition_duration,complete:function(){n.trigger("transitionEnd")}})})},fade:function(t){var n=this;this.on("transition",function(i){i.current?i.current.animate({opacity:0},{duration:t.transition_duration/2,complete:function(){i.next.animate({opacity:1},{duration:t.transition_duration/2,complete:function(){n.trigger("transitionEnd")}})}}):i.next.animate({opacity:1},{duration:t.transition_duration,complete:function(){n.trigger("transitionEnd")}})})},slide:function(t){var n=this;this.on("transition",function(i){var e=n.context,o=n.clone(i.next),s=n.clone(i.current),a=e.width(),r=!1,l=$("<div/>").css({width:"100%",height:"100%",top:0,left:0,position:"absolute",overflow:"hidden"}),c=$("<div/>").css({width:2*a,height:"100%",top:0,left:i.forward?0:"-"+a+"px",position:"relative"}).appendTo(l),h=function(){i.next.css({opacity:1}),l.remove(),n.trigger("transitionEnd")},u=["Webkit","Moz","O","ms",""],d=!1;u.forEach(function(t,n){if(t+"Transform"in document.body.style)return d=t,!1}),d&&(d.length&&(d="-"+d.toLowerCase()+"-"),c.css(d+"transition",d+"transform "+t.transition_duration+"ms "+t.transition_easing),r=!0),s&&(i.forward||s.css({left:a+"px"}),c.append(s)),o.css({opacity:1}),i.forward&&o.css({left:a+"px"}),c.append(o),n.append(l),window.setTimeout(function(){return i.current?("fill"!==n.options.crop&&i.current.css({opacity:0}),void requestAnimationFrame(function(){a=i.forward?"-"+a:a,r?(c.bind("webkitTransitionEnd mozTransitionEnd msTransitionEnd oTransitionEnd transitionend",h),c.css(d+"transform","translate3d("+a+"px,0,0)")):c.animate({left:a},{duration:t.transition_duration,easing:t.transition_easing,complete:h})})):void h()},i.current?50:250)})}},window.Pulse.register_transition=function(t){window.Pulse.transitions=$.extend(window.Pulse.transitions,t)},function(){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},n="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)t.supportsFullScreen=!0;else for(var i=0,e=n.length;i<e;i++)if(t.prefix=n[i],"undefined"!=typeof document[t.prefix+"CancelFullScreen"]){t.supportsFullScreen=!0;break}t.supportsFullScreen&&(t.fullScreenEventName=t.prefix+"fullscreenchange",t.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},t.requestFullScreen=function(t){return""===this.prefix?t.requestFullScreen():t[this.prefix+"RequestFullScreen"]()},t.cancelFullScreen=function(t){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}),Pulse.fullScreenApi=t}();